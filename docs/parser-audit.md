# Аудит текущих парсеров (перед удалением и пересборкой)

Ниже список всех обнаруженных парсерных маршрутов и их текущее назначение.

## 1) Локальные/legacy парсеры (кандидаты на удаление)

- `app/api/parser/route.ts`
  - Старый общий парсер с обходом страниц.
  - **Статус:** Legacy / кандидат на удаление после миграции.

- `app/api/full-parser/route.ts`
  - Полный парсинг всей базы.
  - **Статус:** Legacy / кандидат на удаление.

- `app/api/parse-single-page/route.ts`
  - Обработка одной страницы + next_page.
  - **Статус:** Legacy / можно удалить после отказа от старого UI.

- `app/api/parse-latest/route.ts`
  - Упрощённый парсинг последних обновлений (1 страница).
  - **Статус:** Legacy / кандидат на удаление.

- `app/api/parse-daily/route.ts`
  - Инкрементальный daily-эндпоинт из предыдущей итерации.
  - **Статус:** Legacy / оставлен временно, можно удалить после проверки нового ручного парсера.

## 2) Новый ручной парсер (основной)

- `app/api/manual-parser/route.ts`
  - Ручной запуск с выбором периодов:
    - `24h`
    - `7d`
    - `30d`
    - `180d`
  - Поддерживает debug-режим `singleAnimeDebug=true` (обрабатывает только 1 аниме).
  - Поддерживает `dryRun=true` без записи в БД.
  - **Статус:** Основной endpoint для ручного использования.

## 3) Админ UI

- `app/admin/parser/page.tsx`
  - Полностью обновлён под новый ручной сценарий:
    - кнопки запуска по каждому периоду;
    - тестовые кнопки “1 аниме”;
    - блоки статистики;
    - логи API + логи UI.
  - **Статус:** Основной UI для ручного ежедневного запуска.

## Рекомендация по удалению legacy

После 2–3 дней стабильной ручной работы через `/admin/parser`:
1. Удалить legacy-роуты из пункта (1).
2. Оставить только `manual-parser`.
3. Позже добавить автоматизацию cron поверх `manual-parser` (без дублирования логики).
